# -*- coding: utf-8 -*-
"""gmaps_scraping

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1AsdIS_1iLx32vnBph359mqhp72SysTA1
"""

# Untuk load data dari gdrive
from google.colab import drive
# Untuk pengolahan data
import pandas as pd
import numpy as np
from zipfile import ZipFile
from pathlib import Path
from IPython.display import display
from selenium import webdriver
from selenium.webdriver.common.by import By
from selenium.webdriver.common.keys import Keys
from selenium.webdriver.chrome.options import Options
import time
import pandas as pd

"""# Load Dataset `tour`"""

url = 'https://drive.google.com/file/d/1DUDSMdnADerCl2PnlkddetEahHK1nF3L/view?usp=drive_link'
path = 'https://drive.google.com/uc?export=download&id='+url.split('/')[-2]
maps = pd.read_csv(path)

maps

"""# Membuat Fungsi Scraping Link Lokasi"""

# Daftar tempat wisata
places = ['Taman Pintar Yogyakarta', 'Keraton Yogyakarta', 'Sindu Kusuma Edupark (SKE)', 'Museum Benteng Vredeburg Yogyakarta', 'De Mata Museum Jogja', 'Kampung Wisata Taman Sari', 'Situs Warungboto', 'Nol Kilometer Jl.Malioboro', 'Gembira Loka Zoo', 'Sumur Gumuling', 'Desa Wisata Sungai Code Jogja Kota', 'Alun Alun Selatan Yogyakarta', 'Monumen Yogya Kembali', 'Taman Pelangi Yogyakarta', 'Kampung Wisata Kadipaten', 'Taman Budaya Yogyakarta', 'Budaya', 'Kampung Wisata Sosro Menduran', 'Monumen Batik Yogyakarta', 'Tugu Pal Putih Jogja', 'Taman Hiburan', 'Tebing Breksi', 'Candi Donotirto', 'Kawasan Malioboro', 'Bangsal Pagelaran', 'Budaya', 'Embung Tambakboyo', 'Hutan Pinus Pengger', 'Monumen Serangan Umum 1 Maret', 'Puncak Pinus Becici', 'Bukit Bintang Yogyakarta', 'Taman Hiburan', 'Gedung Agung Yogyakarta', 'The Lost World Castle', 'Monumen Sanapati', 'Jurang Tembelan Kanigoro', 'The World Landmarks - Merapi Park Yogyakarta', 'Museum Sonobudoyo Unit I', 'Budaya', 'Lava Bantal', 'Bukit Panguk Kediwung', 'Candi Prambanan', 'Watu Goyang', 'Kampung Wisata Rejowinangun', 'Budaya', 'Kauman Pakualaman Yogyakarta', 'Budaya', 'Alun-alun Utara Keraton Yogyakarta', 'Pantai Goa Cemara', 'Blue Lagoon Jogja', 'Gumuk Pasir Parangkusumo', 'Bukit Lintang Sewu', 'Taman Hiburan', 'Studio Alam Gamplong', 'Watu Lumbung', 'Air Terjun Kedung Pedut', 'Puncak Kebun Buah Mangunan', 'Taman Hiburan', 'Desa Wisata Gamplong', 'Kawasan Wisata Sosrowijayan', 'Grojogan Watu Purbo Bangunrejo', 'Wisata Alam Kalibiru', 'Jogja Exotarium', 'Puncak Gunung Api Purba - Nglanggeran', 'Bendung Lepen', 'Bunker Kaliadem Merapi', 'Ledok Sambi', 'Seribu Batu Songgo Langit', 'Goa Jomblang', 'Desa Wisata Rumah Domes/Teletubbies', 'Bukit Wisata Pulepayung', 'Bentara Budaya Yogyakarta (BBY)', 'Goa Rancang Kencono', 'Goa Cerme', 'Wisata Kraton Jogja', 'Desa Wisata Kelor', 'Pantai Patihan', 'Pantai Kukup', 'Pantai Ngrawe (Mesra)', 'Pantai Ngobaran', 'Pantai Pulang Sawal', 'Pantai Baron', 'Pantai Pok Tunggal', 'Hutan Pinus Asri', 'Pasar Kebon Empring Bintaran', 'Bukit Paralayang, Watugupit', 'Kampung Wisata Dipowinatan', 'Watu Mabur Mangunan', 'Cagar Alam', 'Pintoe Langit Dahromo', 'Green Village Gedangsari', 'Taman Hiburan', 'Kebun Teh Nglinggo', 'Geoforest Watu Payung Turunan', 'Pantai Timang', 'Bahari', 'Puncak Segoro', 'Candi Borobudur', 'Candi Ijo', 'Budaya', 'Pantai Indrayanti', 'Pantai Nglambor', 'Pasar Beringharjo', 'Museum Ullen Sentalu', 'Budaya', 'Museum Gunung Merapi', 'Pantai Parangtritis', 'Goa Pindul', 'Candi Ratu Boko', 'Pantai Depok Jogja', 'Pantai Sundak', 'Hutan Mangrove Kulon Progo', 'Bahari', 'Jogja Bay Pirates Adventure Waterpark', 'Pantai Sepanjang', 'Pantai Krakal', 'Pantai Glagah', 'Pantai Siung', 'Pantai Sadranan', 'Pantai Nguluran', 'Pantai Samas', 'Pantai Drini', 'Air Terjun Sri Gethuk', 'Candi Sewu', 'Pantai Wediombo', 'Pantai Jogan', 'Pantai Ngrenehan', 'Pantai Jungwok', 'Pantai Greweng', 'Pantai Sedahan', 'Pantai Watu Kodok', 'Pantai Kesirat', 'Pantai Ngandong', 'Galaxy Waterpark Jogja', 'Desa Wisata Pulesari', 'Desa Wisata Tembi', 'Wisata Kaliurang', 'Heha Sky View', 'Taman Sungai Mudal', 'Pantai Sanglen', 'Pantai Congot']

# Setup Chrome driver
options = Options()
options.add_argument("--headless")
options.add_argument("--no-sandbox")
options.add_argument("--disable-dev-shm-usage")

driver = webdriver.Chrome(options=options)

results = []

for place in places:
    driver.get("https://www.google.com/maps")
    time.sleep(2)

    search_box = driver.find_element(By.ID, "searchboxinput")
    search_box.clear()
    search_box.send_keys(place)
    search_box.send_keys(Keys.RETURN)

    time.sleep(5)  # beri waktu untuk load hasil

    url = driver.current_url
    print(f"{place} => {url}")
    results.append({"Place_Name": place, "Google_Maps_Link": url})

driver.quit()

# Simpan ke Excel
df = pd.DataFrame(results)
df.to_excel("hasil_google_maps_links.xlsx", index=False)
print("âœ… Hasil disimpan ke hasil_google_maps_links.xlsx")

# simpan ke csv
df.to_csv('hasil_google_maps_links.csv', index=False)

"""# Load dataset `hasil_google_maps_links`"""

url = 'https://drive.google.com/file/d/1UCXICU6J8F59wBawEpTWZHqimOn330Z4/view?usp=drive_link'
path = 'https://drive.google.com/uc?export=download&id='+url.split('/')[-2]
link = pd.read_csv(path)

link

"""# Cek dan Hapus Missing Value pada Place_Name"""

# Cek kolom Place_Name di data link yang beda dengan Place_Name di data maps
link[~link['Place_Name'].isin(maps['Place_Name'])]

# hapus
link = link[link['Place_Name'] != 'Taman Hiburan']

"""# Merge data berdasarkan Place_Name"""

# gabung data maps dan link menurut Place_Name maps, abaikan kapital
maps = maps.merge(link, on='Place_Name', how='left')

maps

# simpan maps ke excel
maps.to_excel('maps.xlsx', index=False)

"""# Mengambil Place_Name dan Google_Maps_Link"""

# Membuat dataset bernama gmaps, isinya Place_Name dan Google_Maps_Link
gmaps = maps[['Place_Name', 'Google_Maps_Link']]

# simpan ke csv dan excel
gmaps.to_csv('gmaps.csv', index=False)
gmaps.to_excel('gmaps.xlsx', index=False)